{"version":3,"sources":["components/Message.js","components/Modal.js","components/Transcript.js","components/Chatroom.js","utils/api-call.js","components/Layout.js","App.js","serviceWorker.js","index.js"],"names":["Message","name","message","isCurrentUser","className","Modal","onClose","e","props","this","show","id","header","children","onClick","React","Component","Transcript","context","Chatroom","showUsernameModal","event","setState","state","showRoomModal","enterUsername","preventDefault","showModal","room","messages","handleNameChange","bind","handleMessageChange","handleSubmit","toggleRoom","console","log","socket","emit","initSocket","on","isAIUser","addMessage","playAudio","target","value","updateContext","replace","trim","sendAIMessage","fetch","method","headers","Accept","body","JSON","stringify","model_size","top_p","temperature","max_time","then","response","json","myJson","longest","sentences","forEach","sentence","length","res","file","Audio","play","onSubmit","type","onChange","map","m","i","key","Layout","io","App","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error"],"mappings":"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","file":"static/js/main.b28f9884.chunk.js","sourcesContent":["import React from \"react\";\n\nexport const Message = ({ name, message, isCurrentUser }) => {\n  return (\n    <li>\n      <span className={isCurrentUser ? \"name current-user\" : \"name\"}>\n        {name}:{\" \"}\n      </span>\n      {message}\n    </li>\n  );\n};\n","import React from \"react\";\n\nexport default class Modal extends React.Component {\n  onClose = e => {\n    this.props.onClose && this.props.onClose(e);\n  };\n\n  render() {\n    if (!this.props.show) {\n      return null;\n    }\n    return (\n      <div className=\"modal-container\">\n        <div className=\"modal\" id=\"modal\">\n          <h2>{this.props.header}</h2>\n          <div className=\"content\">{this.props.children}</div>\n          <div className=\"actions\">\n            <button className=\"toggle-button\" onClick={this.onClose}>\n              close\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\n\nexport default class Transcript extends React.Component {\n  render() {\n    return (\n      <div className=\"transcript\">\n        {this.props.context && <h2> Transcript</h2>}\n        <div>{this.props.context}</div>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport { Message } from \"./Message\";\nimport Modal from \"./Modal\";\nimport Transcript from \"./Transcript\";\n\nimport { apiCall } from \"../utils/api-call\";\n\nexport class Chatroom extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      room: \"Default Room\",\n      name: \"guest\",\n      message: \"\",\n      messages: [],\n      context: \"\",\n      showUsernameModal: true,\n      showRoomModal: false\n    };\n\n    this.handleNameChange = this.handleNameChange.bind(this);\n    this.handleMessageChange = this.handleMessageChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.toggleRoom = this.toggleRoom.bind(this);\n  }\n\n  toggleRoom(event) {\n    console.log(\"toggleRoom()\");\n    this.setState({room: (this.state.room == \"Default Room\") ? \"Room 1\" : \"Default Room\"},\n      function () {\n        this.props.socket.emit(\"room\", (this.state.room == \"Default Room\") ? \"Room 1\" : \"Default Room\", this.state.room);\n      }\n    );\n  }\n\n  componentDidMount() {\n    const { socket } = this.props;\n    this.initSocket(socket);\n  }\n\n  initSocket(socket) {\n    // receive message code\n    socket.on(\"chat message\", (name, message, isCurrentUser, isAIUser) => {\n      this.addMessage(name, message, isCurrentUser, isAIUser);\n      if (isCurrentUser) {\n        this.playAudio(\"./audio/outgoing-message.wav\");\n      } else {\n        this.playAudio(\"./audio/incoming-message.mp3\");\n      }\n    });\n  }\n\n  handleNameChange(event) {\n    this.setState({ name: event.target.value });\n  }\n\n  handleMessageChange(event) {\n    this.setState({ message: event.target.value });\n  }\n\n  addMessage(name, message, isCurrentUser, isAIUser) {\n    console.log(\"I added\");\n\n    //Keep track of all message text, including punctuation\n    this.updateContext(message);\n    console.log(isAIUser);\n    if (isAIUser) {\n      //clean it up before adding it to the messages state\n      message = message\n        .replace(/[\\r\\n]/g, \" \")\n        .replace(/[\\/#.,;!?$%\\^&\\*:{}=\\_`~()]/g, \" \")\n        .replace(/[\"]/g, \"<-\")\n        .replace(/\\s\\s+/g, \" \")\n        .trim();\n\n      console.log(message);\n    }\n    // adding some message to our state\n    this.setState({\n      messages: [\n        ...this.state.messages,\n        { name: name, message: message, isCurrentUser: isCurrentUser }\n      ]\n    });\n\n    // Send an AI message\n    if (isCurrentUser) {\n      this.sendAIMessage();\n    }\n  }\n\n  updateContext(message) {\n    this.setState({ context: `${this.state.context} ${message}` });\n  }\n\n  sendAIMessage() {\n    apiCall(this.state.context).then(res =>\n      this.props.socket.emit(\"AI message\", `Robot from ${this.state.name}`, res, this.state.room)\n    );\n  }\n\n  playAudio(file) {\n    let audio = new Audio(file);\n    audio.play();\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    this.props.socket.emit(\"chat message\", this.state.name, this.state.message, this.state.room);\n    this.setState({\n      message: \"\"\n    });\n  }\n\n  showUsernameModal = event => {\n    this.setState({\n      showUsernameModal: !this.state.showUsernameModal\n    });\n  };\n\n  showRoomModal = event => {\n    this.setState({\n      showRoomModal: !this.state.showRoomModal\n    });\n  };\n\n\n  enterUsername = event => {\n    event.preventDefault();\n    this.showModal();\n  };\n\n  render() {\n    return (\n      <div>\n        <Modal onClose={this.showUsernameModal} show={this.state.showUsernameModal} header=\"Enter Username\">\n          <form onSubmit={this.enterUsername}>\n            <input\n              id=\"name\"\n              type=\"text\"\n              value={this.state.name}\n              onChange={this.handleNameChange}\n            />\n          </form>\n        </Modal>\n        <Modal onClose={this.showRoomModal} show={this.state.showRoomModal} header=\"Switch Room\">\n          <button onClick={this.toggleRoom}> Switch Room </button>\n        </Modal>\n        <button className=\"modal-button\" onClick={this.showUsernameModal}>\n          Change Username\n        </button>\n         <button className=\"modal-button\" onClick={this.showRoomModal}>\n          Change Room\n        </button>\n        <h1>{this.state.room}</h1>\n        <div className=\"chatroom-container\">\n          <div className=\"chat-window\">\n            <ul id=\"messages\">\n              {this.state.messages.map((m, i) => (\n                <Message\n                  key={i}\n                  name={m.name}\n                  message={m.message}\n                  isCurrentUser={m.isCurrentUser}\n                />\n              ))}\n            </ul>\n            <form onSubmit={this.handleSubmit} className=\"message-form\">\n              <input\n                id=\"message\"\n                type=\"text\"\n                value={this.state.message}\n                onChange={this.handleMessageChange}\n              />\n              <button>Send</button>\n            </form>\n          </div>\n          <div className=\"transcript-window\">\n            <Transcript context={this.state.context} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","export const apiCall = context => {\n  return fetch(\"https://transformer.huggingface.co/autocomplete/gpt2/large\", {\n    method: \"POST\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      context: context,\n      model_size: \"gpt2/large\",\n      top_p: 0.9,\n      temperature: 1,\n      max_time: 1\n    })\n  })\n    .then(response => {\n      return response.json();\n    })\n    .then(myJson => {\n      // picks the longest response out of the three response messages\n      let longest = \"\";\n      myJson.sentences.forEach(sentence => {\n        if (sentence.value.length > longest.length) {\n          longest = sentence.value;\n        }\n      });\n      \n      return longest;\n    });\n};\n","import React from \"react\";\nimport io from \"socket.io-client\";\nimport { Chatroom } from \"./Chatroom\";\n\nconst socketUrl = \"http://localhost:4000/\";\nexport class Layout extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      socket: null\n    };\n  }\n\n  componentWillMount() {\n    this.initSocket();\n  }\n\n  initSocket = () => {\n    const socket = io(socketUrl);\n\n    socket.on(\"connect\", () => {\n      console.log(\"Connected\");\n    });\n\n    this.setState({ socket });\n  };\n\n  render() {\n    const { socket } = this.state;\n    return <Chatroom socket={socket} />;\n  }\n}\n","import React from \"react\";\nimport \"./style/main.css\";\nimport { Layout } from \"./components/Layout.js\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\"></header>\n      <Layout />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}